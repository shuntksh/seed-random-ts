import { describe, expect, test } from "bun:test";
import fc from "fast-check";

import { seedRandom } from "./seed-random";

describe("seed`Random", () => {
	test("should always generate numbers within the range [0, 1]", () => {
		fc.assert(
			fc.property(fc.string({ minLength: 1 }), (seed) => {
				const rng = seedRandom(seed);
				for (let i = 0; i < 100; i++) {
					const num = rng();
					expect(num).toBeGreaterThanOrEqual(0);
					expect(num).toBeLessThanOrEqual(1);
				}
			}),
		);
	});

	test("should generate the same sequence for the same seed", () => {
		const seed = "test-seed";
		const rng1 = seedRandom(seed);
		const rng2 = seedRandom(seed);
		for (let i = 0; i < 100; i++) {
			expect(rng1()).toEqual(rng2());
		}
	});

	test("should generate random numbers that is deterministic", () => {
		const rng = seedRandom("My Seed");
		const numbers = Array.from({ length: 100 }, () => rng());
		expect(numbers).toMatchInlineSnapshot(`
          [
            0.12074459111317992,
            0.7390268826857209,
            0.03852009354159236,
            0.09597742324694991,
            0.4499326809309423,
            0.1302951469551772,
            0.1216015862300992,
            0.7428564559668303,
            0.4111012958455831,
            0.6202841917984188,
            0.5347612244077027,
            0.5037029287777841,
            0.6068492580670863,
            0.43296097964048386,
            0.6905062629375607,
            0.5755394843872637,
            0.07078977604396641,
            0.8295153074432164,
            0.8319205665029585,
            0.656655112048611,
            0.5681796960998327,
            0.5022036535665393,
            0.44231538800522685,
            0.8116903472691774,
            0.7480189646594226,
            0.11609643651172519,
            0.18648716155439615,
            0.6396165613550693,
            0.8347332316916436,
            0.8201630141120404,
            0.9448669743724167,
            0.5823137692641467,
            0.9470808070618659,
            0.6138087646104395,
            0.1904900383669883,
            0.1524856595788151,
            0.3510622412431985,
            0.3936588123906404,
            0.9526085413526744,
            0.47528594243340194,
            0.12486091302707791,
            0.17701807734556496,
            0.6138093764893711,
            0.9554945072159171,
            0.9143418068997562,
            0.6305170587729663,
            0.5758775172289461,
            0.9831073225941509,
            0.07074011047370732,
            0.874566295882687,
            0.6174039579927921,
            0.7744098855182528,
            0.9725882175844163,
            0.19771799724549055,
            0.9188361871056259,
            0.44721718644723296,
            0.6745142086874694,
            0.6036577122285962,
            0.9090907748322934,
            0.22516264324076474,
            0.01387659553438425,
            0.7194734232034534,
            0.966388194821775,
            0.8285165973939002,
            0.6714426057878882,
            0.23777920426800847,
            0.62772700865753,
            0.5409310581162572,
            0.2573629238177091,
            0.29277722514234483,
            0.497772931586951,
            0.32887458126060665,
            0.2625448440667242,
            0.2769941803999245,
            0.9005157682113349,
            0.03525903983972967,
            0.8306253764312714,
            0.9010406837332994,
            0.1832698811776936,
            0.4317504991777241,
            0.8350877470802516,
            0.4314354343805462,
            0.1824388476088643,
            0.10042545176111162,
            0.18093897704966366,
            0.20898386533372104,
            0.7915850069839507,
            0.0210660882294178,
            0.8031908757984638,
            0.07252467819489539,
            0.6521035912446678,
            0.36027448205277324,
            0.445766044780612,
            0.30352272489108145,
            0.1576839534100145,
            0.6443143272772431,
            0.9689855435863137,
            0.906774383969605,
            0.9752686370629817,
            0.953715112991631,
          ]
        `);
	});
});
